@*
 * Copyright 2020 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

§§@import _root_.template.Helper._
@import helpers._
@import models.pages.Summary
@import play.api.data._
@import uk.gov.hmrc.govukfrontend.views.Aliases.{Fieldset, Text}
@import uk.gov.hmrc.govukfrontend.views.html.components.{GovukRadios, GovukWarningText}
@import uk.gov.hmrc.govukfrontend.views.viewmodels.fieldset.Legend
@import uk.gov.hmrc.govukfrontend.views.viewmodels.radios.{RadioItem, Radios}
@import models.serviceContracts.submissions.AddressConnectionTypeYesChangeAddress
@import models.serviceContracts.submissions.AddressConnectionTypeNo
@import models.serviceContracts.submissions.AddressConnectionTypeYes

@this(
    main_template: main2,
    govukWarningText: GovukWarningText,
    govukRadios: GovukRadios
)


@(theForm: Form[_], summary: Summary)(implicit request: Request[_],  messages: Messages)

@stripIndices(field: String) = @{
    field.replaceAll("""\[[0-9]\]""", "")
}

@main_template(
    pageHeading = messages("section0.heading")
) {

    @form(action = dataCapturePages.routes.PageController.savePage(0), args = 'class -> "section0", 'id -> "myFormId") {

      @if(theForm.hasErrors) {
          <div class="form-error alert alert-danger" role="alert" tabindex="-1" aria-labelledby="error-summary-heading" >
              <h2 id="error-summary-heading">@Messages("label.checkTheForm")</h2>
              <ul>
              @for(error <- theForm.errors) {
                  <li>
                      <a href="#@error.key.replace("[", "_").replace(".", "_").replace("]", "_").replace("__", "_")">
                      @Messages(stripIndices(error.message), error.args: _*)
                      </a>
                  </li>
              }
              </ul>
          </div>
      }

        @helper.CSRF.formField

        @inputRadioGroup(
          field = theForm("isRelated"),
          options = Seq(
            AddressConnectionTypeYes.name -> Messages("label.yes.oes"),
            AddressConnectionTypeYesChangeAddress.name -> Messages("label.yes.change.address"),
            AddressConnectionTypeNo.name -> Messages("label.no.nac.oes")
          ),
          args = Seq(
            '_label -> headingDisplayPlain(0, (Messages("section0.intro.text") + " " + summary.address.map(_.singleLine).getOrElse("") + " ?"), false),
            '_legend -> true,
            '_labelClass -> "",
            '_showConstraints -> true
          )
        )
    }

    @includes.formHelp2()
}
